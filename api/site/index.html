<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="/style.css">
  <script type="module" src="/js/components/index.js"></script>
  <style>
    main {
      display: grid;
      grid-template-columns: 1fr 1fr;
      column-gap: 1.5rem;
    }

    .boxes-container a {
      display: block;
      margin-block-end: 1.5rem;
    }

  </style>
  <title>Übersicht - Marc's Pics</title>
</head>

<body>
  <header>
    <nav>
      <button type="button">Ausloggen</button>
    </nav>
  </header>
  <h1>Übersicht</h1>

  <main>
    <section class="boxes-container">
      <h2>Deine Fotoboxen</h2>
      <a href="/new-photo-box">Neue Fotobox erstellen</a>
      <mp-details-list></mp-details-list>
    </section>
    <section class="collections-container">
      <h2>Deine Kollektionen</h2>
      <div class="collections">
        <p><i>Du hast noch keine Kollektionen erstellt..!</i></p>
      </div>
    </section>
  </main>
</body>

<script type="module">
  import { checkAuth, logoutUser } from '/js/auth.js';
  import { getAllPhotoBoxes } from '/js/photo-box.js';
  import { getAllCollections } from '/js/collection.js';
  await checkAuth();

  // Elements
  const btnLogout = document.querySelector('button');
  const mpDetailsList = document.querySelector('mp-details-list');
  const collectionsList = document.querySelector('.collections');

  async function onLogout() {
    await logoutUser();
  }
  btnLogout.addEventListener('click', onLogout);

  mpDetailsList.items = await getAllPhotoBoxes();
  const collections = await getAllCollections();

  if (collections.length > 0) {
    collectionsList.innerHTML = '';

    collections.forEach(collection => {
      const collectionSummaryEl = document.createElement('mp-collection-summary');
      collectionSummaryEl.data = collection;
      collectionsList.appendChild(collectionSummaryEl);
    });
  }
</script>

</html>
